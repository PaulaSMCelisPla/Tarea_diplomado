---
title: "Tarea_diplomado_Paula"
author: "Paula Celis Plá"
date: "2022-09-27"
output:
  pdf_document: default
  html_document: default
---

## Habilita Librerias 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(stats)
library(graphics)
library(psych)
library(readxl)
library(agridat)
library(ggplot2)
```

## Summary

```{r cars}
summary(cars)
```

## Variables categoricas Seasons, time, hours  y replicate asigna factor  

```{r}
Datos_Proyecto <- read_excel("Datos_Proyecto.xlsx")
summary(Datos_Proyecto)
```

## Transforma variables a factores

```{r}
Datos_Proyecto$Seasons <- as.factor(Datos_Proyecto$Seasons)
Datos_Proyecto$time <- as.factor(Datos_Proyecto$time)
Datos_Proyecto$Replicate <- as.factor(Datos_Proyecto$Replicate)

summary(Datos_Proyecto)
```

## Including Plots

## 3. Histogramas con etiquetas y títulos

```{r}
ggplot(Datos_Proyecto, aes(Chla)) + geom_histogram()+ labs(title="Histograma Chla", x="Clorofila a", y="Frecuencia")
ggplot(Datos_Proyecto, aes(Chlc)) + geom_histogram()+ labs(title="Histograma Clorofila c", x="Chlc", y="Frecuencia")
ggplot(Datos_Proyecto, aes(Car)) + geom_histogram()+ labs(title="Histograma Carotenos", x="Car", y="Frecuencia")
ggplot(Datos_Proyecto, aes(PC)) + geom_histogram()+ labs(title="Histograma Compuestos fenólicos", x="PC", y="Frecuencia")
ggplot(Datos_Proyecto, aes(DPPH)) + geom_histogram()+ labs(title="Histograma DPPH", x="DPPH", y="Frecuencia")
ggplot(Datos_Proyecto, aes(Temperature)) + geom_histogram()+ labs(title="Histograma Tempertura", x="Temperature", y="Frecuencia")
ggplot(Datos_Proyecto, aes(pH)) + geom_histogram()+ labs(title="Histograma pH", x="pH", y="Frecuencia")
ggplot(Datos_Proyecto, aes(Salinity)) + geom_histogram()+ labs(title="Histograma Salinity", x="Salinity", y="Frecuencia")
ggplot(Datos_Proyecto, aes(PAR)) + geom_histogram()+ labs(title="Histograma Radiación fotosintéticamnete activa", x="PAR", y="Frecuencia")
```

## 4. Datos balanceados y tablas de frecuencia

```{r}
str(Datos_Proyecto)
Datos_Proyecto$Seasons <- as.factor(Datos_Proyecto$Seasons)
Datos_Proyecto$time <- as.factor(Datos_Proyecto$time)
Datos_Proyecto$Replicate <- as.factor(Datos_Proyecto$Replicate)
summary(Datos_Proyecto)

Datos_Proyecto$Chla
tableChla <-as.data.frame(table(Chla = Datos_Proyecto$Chla))
tableChla

Datos_Proyecto$Chlc
tableChlc <-as.data.frame(table(Chlc = Datos_Proyecto$Chlc))
tableChlc

Datos_Proyecto$Car
tableCar <-as.data.frame(table(Car = Datos_Proyecto$Car))
tableCar

Datos_Proyecto$PC
tablePC <-as.data.frame(table(PC = Datos_Proyecto$PC))
tablePC

Datos_Proyecto$DPPH
tableDPPH <-as.data.frame(table(DPPH = Datos_Proyecto$DPPH))
tableDPPH

Datos_Proyecto$Temperature
tableTemp <-as.data.frame(table(Temperature = Datos_Proyecto$Temperature))
tableTemp

Datos_Proyecto$pH
tablepH <-as.data.frame(table(pH = Datos_Proyecto$pH))
tablepH

Datos_Proyecto$Salinity
tableSalinity <-as.data.frame(table(Salinity = Datos_Proyecto$Salinity))
tableSalinity

Datos_Proyecto$PAR
tablePAR <-as.data.frame(table(PAR = Datos_Proyecto$PAR))
tablePAR

```


## 5. Relación entre variables cuantitativas y factores

** No se incluiran las variables Seasons, time, y Replicate porque son variables categóricas. 

```{r}
summary(Datos_Proyecto)
```

## 5. Graficas de correlación de variables continuas (pearson)

```{r}
pairs.panels(Datos_Proyecto[,4:12], method = "pearson", hist.col = "blue", density = TRUE, font=4)

```
** Correlación entre las primeras 4 variables continuas 

```{r}
pairs.panels(Datos_Proyecto[,4:7], method = "pearson", hist.col = "blue", density = TRUE, font=2)
```
** Correlación entre las segundas 4 variables continuas 

```{r}
pairs.panels(Datos_Proyecto[,9:12], method = "pearson", hist.col = "blue", density = TRUE, font=2)
```

## 5. Relación entre variables continuas y factores (boxplot)


```{r}
ggplot(Datos_Proyecto, aes(x= Seasons, y=Chla))+geom_boxplot(fill="olivedrab1")+labs(title = "BoxPlot", x= "Seasons", y= "Clorofila a")
ggplot(Datos_Proyecto, aes(x= Seasons, y=Chlc))+geom_boxplot(fill="red")+labs(title = "BoxPlot", x= "Seasons", y= "Clorofila c")
ggplot(Datos_Proyecto, aes(x= Seasons, y=Car))+geom_boxplot(fill="blue")+labs(title = "BoxPlot", x= "Seasons", y= "Carotenos")
ggplot(Datos_Proyecto, aes(x= Seasons, y=PC))+geom_boxplot(fill="green")+labs(title = "BoxPlot", x= "Seasons", y= "Compuestos fenólicos")
ggplot(Datos_Proyecto, aes(x= Seasons, y=DPPH))+geom_boxplot(fill="brown")+labs(title = "BoxPlot", x= "Seasons", y= "DPPH")
ggplot(Datos_Proyecto, aes(x= Seasons, y=Temperature))+geom_boxplot(fill="blue")+labs(title = "BoxPlot", x= "Seasons", y= "Temperatura")
ggplot(Datos_Proyecto, aes(x= Seasons, y=pH))+geom_boxplot(fill="green")+labs(title = "BoxPlot", x= "Seasons", y= "pH")
ggplot(Datos_Proyecto, aes(x= Seasons, y=Salinity))+geom_boxplot(fill="brown")+labs(title = "BoxPlot", x= "Seasons", y= "Salinity")
ggplot(Datos_Proyecto, aes(x= Seasons, y=PAR))+geom_boxplot(fill="yellow")+labs(title = "BoxPlot", x= "Seasons", y= "Radiación PAR")
```

## 6. Identificación de outliers o error atípico 

Variable Chlc : para la estación winter se registra un outlier
Variable Car : para la estación summer se registra un outlier
Variable PC : se registran 2 valores en Spring
Variable Temperature: 3 valores en spring 
Variable pH : 5 valores en spring 
Variable Salinity: 3 valores en spring, 2 en summer y 1 en winter
Variable PAR: 1 en autumn, 1 en spring y 1 en summer 

## 7. Resumen de los datos con tablas y estadística descriptiva 

## Habilita librerias 

```{r}
library(readxl)
library(tidyr)
library(dplyr)
library(ggplot2)
```

```{r}
Datos_Proyecto <- read_excel("Datos_Proyecto.xlsx" , sheet= 1)
head(Datos_Proyecto)
Datos_Proyecto$Seasons <- as.factor(Datos_Proyecto$Seasons)
Datos_Proyecto$time <- as.factor(Datos_Proyecto$time)
Datos_Proyecto$Replicate <- as.factor(Datos_Proyecto$Replicate)

select(Datos_Proyecto, Chla, Chlc, Car, DPPH)

```
```{r}
Datos_tab <- Datos_Proyecto %>% group_by(Seasons) %>% summarize(n = n(), 
Promedio_Chla = mean(Chla), Maximo_Chla = max(Chla), Promedio_Chlc = mean(Chlc), Maximo_Chlc = max(Chlc), Promedio_Car = mean(Car), Maximo_Car = max(Car), Promedio_PC = mean(PC), Maximo_PC = max(PC), Promedio_DPPH = mean(DPPH), Maximo_DPPH = max(DPPH), Promedio_Temperature = mean(Temperature), Maximo_Temperature = max(Temperature),Promedio_pH = mean(pH), Maximo_pH = max(pH), Promedio_Salinity = mean(Salinity), Maximo_Salinity = max(Salinity), Promedio_PAR = mean(PAR), Maximo_PAR = max(PAR))
```


```{r}
Datos_tab2 <- Datos_Proyecto %>% group_by(time) %>% summarize(n = n(), 
Promedio_Chla = mean(Chla), Maximo_Chla = max(Chla), Promedio_Chlc = mean(Chlc), Maximo_Chlc = max(Chlc), Promedio_Car = mean(Car), Maximo_Car = max(Car), Promedio_PC = mean(PC), Maximo_PC = max(PC), Promedio_DPPH = mean(DPPH), Maximo_DPPH = max(DPPH), Promedio_Temperature = mean(Temperature), Maximo_Temperature = max(Temperature),Promedio_pH = mean(pH), Maximo_pH = max(pH), Promedio_Salinity = mean(Salinity), Maximo_Salinity = max(Salinity), Promedio_PAR = mean(PAR), Maximo_PAR = max(PAR))
```

## 8. Utiliza Paquetes para importar datos a R como readxl o similar y paquetes tidyr, dplyr, ggplot2

## Habilita librerias 

```{r}
library(readxl)
library(tidyr)
library(dplyr)
library(ggplot2)
```

```{r}
Datos_Proyecto2 <- read_excel("Datos_Proyecto2.xlsx" , sheet= 1)
summary(Datos_Proyecto2)
messy <- read_excel("Datos_Proyecto2.xlsx")
summary(messy)
```
```{r}
Datos_Proyecto2_factor <- read_excel("Datos_Proyecto2.xlsx" , sheet= 2)
Datos_Proyecto2_factor$Seasons <- as.factor(Datos_Proyecto2_factor$Seasons)
Datos_Proyecto2_factor$time <- as.factor(Datos_Proyecto2_factor$time)
Datos_Proyecto2_factor$Replicate <- as.factor(Datos_Proyecto2_factor$Replicate)

inner_data <- inner_join(Datos_Proyecto2, Datos_Proyecto2_factor, "Sample_id")
right_data <- right_join(Datos_Proyecto2, Datos_Proyecto2_factor, "Sample_id")
full_data <- full_join(Datos_Proyecto2, Datos_Proyecto2_factor, "Sample_id")

```






```
You can also embed plots, for example:

```{r pressure, echo=FALSE}

plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
